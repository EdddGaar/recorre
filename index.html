<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Re-corre | Cumplea√±os</title>

  <!-- Fuentes -->
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;700;800;900&family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />

  <!-- Favicon -->
  <link rel="icon" href="https://github.com/EdddGaar/recorre/raw/main/Re%20corre%20Logo.jpg">

  <style>
    :root{ --text:#ffffff; --p1:#6faeff; --p2:#5977ff; --p3:#7a61ff; }
    *{box-sizing:border-box}
    body{ margin:0; font-family:Inter,sans-serif; color:var(--text); background:#1a2040; overflow-x:hidden; }

    /* Fondos */
    .wallpapers{ position:fixed; inset:0; z-index:-5; overflow:hidden; background:#000; }
    .wallpapers img{ position:absolute; inset:0; width:100%; height:100%; object-fit:cover; opacity:0; transition:opacity 1s ease-in-out; }
    .wallpapers img.show{ opacity:1; }
    .gradient{ position:fixed; inset:0; z-index:-4; background:linear-gradient(135deg, var(--p1) 0%, var(--p2) 45%, var(--p3) 80%); background-size:140% 140%; animation:gradientShift 14s ease-in-out infinite alternate; opacity:.78; }
    @keyframes gradientShift{ 0%{background-position:0% 50%} 100%{background-position:100% 50%} }

    /* Estrellas */
    #stars{ position:fixed; inset:0; z-index:-2; pointer-events:none; mix-blend-mode:screen; opacity:.9 }

    /* Confeti */
    .confetti{ position:fixed; top:-10px; width:8px; height:14px; z-index:5; opacity:.98; border-radius:2px; pointer-events:none; animation:fall linear forwards; filter:drop-shadow(0 2px 2px rgba(0,0,0,.12)); mix-blend-mode:screen; }
    @keyframes fall{ to{ transform:translateY(110vh) rotate(520deg); opacity:1 } }

    header{text-align:center; padding:28px 18px 8px}
    .logo{width:120px; height:120px; border-radius:50%; object-fit:cover; border:2px solid rgba(255,255,255,.85); box-shadow:0 0 40px rgba(0,0,0,.35); margin-bottom:12px}
    .brand{font-family:Outfit; font-weight:900; font-size:clamp(28px,4.4vw,52px); color:#fff; text-shadow:0 3px 12px rgba(0,0,0,.45)}

    main{max-width:980px; margin:0 auto 86px; padding:0 18px}
    .phrase{text-align:center; margin:10px auto 18px; font-size:clamp(16px,2.4vw,20px); color:#fff; background:rgba(0,0,0,.20); border:1px solid rgba(255,255,255,.25); border-radius:16px; padding:12px 16px; backdrop-filter: blur(6px)}

    /* Botones */
    .toolbar{display:flex; gap:10px; justify-content:center; flex-wrap:wrap; margin:6px 0 14px}
    .btn{padding:10px 16px; border-radius:999px; cursor:pointer; font-weight:800; border:none; font-family:Inter; background:linear-gradient(180deg,#fff,#f2f5ff); color:#1a2040; box-shadow:0 8px 24px rgba(0,0,0,.25); transition:.2s;}
    .btn.active{background:linear-gradient(180deg, var(--p2), var(--p3)); color:#fff;}

    /* Secciones */
    .section{margin:22px auto; padding:16px; background:rgba(255,255,255,.16); border-radius:22px; backdrop-filter: blur(14px); box-shadow:0 10px 36px rgba(0,0,0,.35)}
    .title-day{text-align:center; font-family:Outfit; font-weight:900; margin:0 0 14px; font-size:clamp(24px,5vw,40px)}
    .cards{display:grid; grid-template-columns:1fr; gap:14px; max-width:760px; margin:0 auto}
    @media(min-width:720px){.cards{grid-template-columns:repeat(2,1fr)}}
    .card{padding:18px 16px; border-radius:18px; background:linear-gradient(180deg,#fff,#f9f9f9); color:#1a2040; box-shadow:0 6px 28px rgba(0,0,0,.3); text-align:center}
    .name{font-family:Outfit; font-weight:900; font-size:20px; margin:0 0 6px}
    .meta{font-size:14px; margin:0 0 8px; color:#333}
    .wish{font-size:15px; margin:0}

    /* Card vac√≠a */
    .empty-card{width:min(520px,92%); margin:0 auto; padding:32px 20px; border-radius:22px; background:linear-gradient(160deg,rgba(255,255,255,.25),rgba(255,255,255,.12)); border:2px dashed rgba(255,255,255,.5); box-shadow:0 8px 28px rgba(0,0,0,.35); text-align:center}
    .empty-card .wish{font-size:clamp(18px,2.4vw,24px); font-weight:700; background:linear-gradient(90deg,#ff7aa2,#7a61ff,#00d1ff); -webkit-background-clip:text; -webkit-text-fill-color:transparent;}
    
    footer{text-align:center; padding:24px 16px; font-size:18px; color:#fff}
  </style>
</head>
<body>
  <div class="wallpapers"></div>
  <div class="gradient"></div>
  <canvas id="stars"></canvas>

  <header>
    <img class="logo" src="https://github.com/EdddGaar/recorre/raw/main/Re%20corre%20Logo.jpg" alt="Logo Re-corre" />
    <div class="brand">Re-corre</div>
  </header>

  <main>
    <p class="phrase" id="status">Cargando cumplea√±er@s‚Ä¶</p>
    <div class="toolbar">
      <button class="btn" id="btn-celebrar">Celebrar</button>
      <button class="btn" id="btn-hoy">Ir a HOY</button>
      <button class="btn active" id="btn-week">Semana</button>
      <button class="btn" id="btn-month">Mes</button>
      <button class="btn" id="btn-year">A√±o</button>
      <button class="btn" id="btn-reload">Recargar</button>
    </div>

    <section class="section" id="week-section">
      <h2 class="title-day">üéâ Cumplea√±os de la Semana</h2>
      <div id="week-view"></div>
    </section>

    <section class="section" id="month-section" style="display:none">
      <h2 class="title-day">üìÖ Cumplea√±os del Mes</h2>
      <div id="month-view"></div>
    </section>

    <section class="section" id="year-section" style="display:none">
      <h2 class="title-day">üåé Cumplea√±os del A√±o</h2>
      <div id="year-view"></div>
    </section>
  </main>

  <footer>
    üèÉ‚Äç‚ôÄÔ∏è #Re-corre Toluca ¬∑ Cumplea√±os runners
    <div id="next-birthday"></div>
    <div id="countdown"></div>
  </footer>

  <script>
    /* === Config === */
    const API_URL = "https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec?route=birthdays"; 
    // üëÜ Reemplaza con tu URL de despliegue del WebApp

    const frasesDivertidas=[
      "Esta semana nadie envejece‚Ä¶ qu√© aburridos",
      "Silencio en la pista‚Ä¶ ni un pastel que correr esta vez",
      "¬°Plot twist! Esta semana no hay pastel, solo kil√≥metros extra",
      "Nadie cumple, pero igual puedes festejar tus agujetas nuevas",
      "Semana libre de velitas‚Ä¶ aprovecha para bajar el tiempo en 10k",
      "Los cumplea√±eros hicieron trampa y se escondieron"
    ];

    function renderEmpty(container){
      container.innerHTML = `<div class="card empty-card"><p class="wish">${frasesDivertidas[Math.floor(Math.random()*frasesDivertidas.length)]}</p></div>`;
    }

    async function fetchBirthdays(){
      try{
        const res = await fetch(API_URL+"&_cb="+Date.now());
        if(!res.ok) throw new Error("Error "+res.status);
        return await res.json();
      }catch(e){
        console.error("Fetch error",e);
        return [];
      }
    }

    function renderCards(container, list){
      container.innerHTML="";
      if(!list.length){ renderEmpty(container); return; }
      list.forEach(p=>{
        const card=document.createElement("div");
        card.className="card";
        card.innerHTML=`<p class="name">${p.name}</p>
                        <p class="meta">${p.date} ¬∑ ${p.pace||'Runner'}</p>
                        <p class="wish">üéÇ ¬°Muchas felicidades!</p>`;
        container.appendChild(card);
      });
    }

    async function boot(){
      document.getElementById("status").textContent="Cargando cumplea√±er@s‚Ä¶";
      const data = await fetchBirthdays();
      window.BIRTHDAYS = data;
      renderCards(document.getElementById("week-view"),data); // üîπ Simplificado: muestra todos
      document.getElementById("status").textContent = data.length? "üéâ Lista cargada" : "Sin cumplea√±er@s";
    }

    /* ===== Confeti ===== */
    function confettiBurst(n=160){
      const colors=['#6faeff','#5977ff','#7a61ff','#00d1ff','#14e0a1','#ffe066','#ffffff'];
      for(let i=0;i<n;i++){
        const el=document.createElement('span'); el.className='confetti';
        el.style.left=(Math.random()*100)+'vw';
        el.style.background=colors[(Math.random()*colors.length)|0];
        el.style.animationDuration=(1.8+Math.random()*1.2)+'s';
        document.body.appendChild(el);
        setTimeout(()=>el.remove(),4000);
      }
    }
    document.getElementById("btn-celebrar").addEventListener("click",()=>confettiBurst());

    /* ===== Wallpapers carrusel ===== */
    const WALLPAPER_URLS=[
      "https://raw.githubusercontent.com/EdddGaar/recorre/main/cumple.jpg",
      "https://raw.githubusercontent.com/EdddGaar/recorre/main/wallpaper%20cumple%20morado.jpg",
      "https://raw.githubusercontent.com/EdddGaar/recorre/main/wallpaper%20de%20globos.jpg"
    ];
    function initWallpapers(){
      const wrap=document.querySelector('.wallpapers');
      WALLPAPER_URLS.forEach((src,i)=>{
        const img=document.createElement('img');
        img.src=src; if(i===0) img.classList.add('show');
        wrap.appendChild(img);
      });
      const imgs=[...wrap.querySelectorAll('img')]; let idx=0;
      setInterval(()=>{imgs[idx].classList.remove('show'); idx=(idx+1)%imgs.length; imgs[idx].classList.add('show');},5000);
    }

    /* ===== Estrellas ===== */
    (function stars(){
      const c=document.getElementById('stars'); const ctx=c.getContext('2d'); let W,H,stars=[];
      function resize(){W=c.width=innerWidth; H=c.height=innerHeight; spawn();}
      function spawn(){stars=new Array(100).fill(0).map(()=>({x:Math.random()*W,y:Math.random()*H,r:Math.random()*1.8+0.6,a:Math.random()*0.5+0.4,speed:Math.random()*0.003+0.0015,phase:Math.random()*Math.PI*2}));}
      function tick(){ctx.clearRect(0,0,W,H); for(const s of stars){s.phase+=s.speed; const alpha=s.a*(0.5+0.5*Math.sin(s.phase)); const grad=ctx.createRadialGradient(s.x,s.y,0,s.x,s.y,s.r*3); grad.addColorStop(0,`rgba(255,255,255,${alpha})`); grad.addColorStop(1,`rgba(255,255,255,0)`); ctx.fillStyle=grad; ctx.beginPath(); ctx.arc(s.x,s.y,s.r,0,Math.PI*2); ctx.fill();} requestAnimationFrame(tick);}
      addEventListener('resize',resize); resize(); tick();
    })();

    document.addEventListener("DOMContentLoaded",()=>{ initWallpapers(); boot(); });
  </script>
</body>
</html>
